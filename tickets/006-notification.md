# チケット #006: 通知機能（メール/Slack/LINE）

## 概要
順位下落とリライト案をメール、Slack、LINEに通知する機能を実装する。

## 目的
ユーザーに順位下落とリライト案を通知し、アクションを促す。

## 実装内容

### 1. メール通知（必須）
- [ ] Resendをインストール・設定
- [ ] メール送信機能の実装
- [ ] メールテンプレートの作成
- [ ] 通知内容のフォーマット
  - 順位下落の詳細
  - 追加すべき項目の箇条書き
- [ ] エラーハンドリングの実装

### 2. Slack通知（オプション）
- [ ] Slack Webhookの設定
- [ ] Slack通知機能の実装
- [ ] 通知内容のフォーマット（メールと同様）
- [ ] エラーハンドリングの実装

### 3. LINE通知（オプション）
- [ ] LINE Notify APIの設定
- [ ] LINE通知機能の実装
- [ ] 通知内容のフォーマット（メールと同様）
- [ ] エラーハンドリングの実装

### 4. 通知内容のフォーマット
- [ ] 順位下落の詳細
  - 記事URL
  - 下落したキーワード
  - 下落幅（例：3位 → 8位）
  - 下落の原因となっているキーワード
- [ ] 追加すべき項目の箇条書き
  - 観点（例：「価格比較」）
  - 項目名（例：「価格比較表」）
  - 挿入位置（可能な場合）

### 5. 通知設定の管理
- [ ] ユーザーの通知先をデータベースに保存
- [ ] 通知設定の取得機能
- [ ] 通知設定の更新機能

## 成果物
- メール送信機能
- Slack通知機能（オプション）
- LINE通知機能（オプション）
- 通知内容のフォーマット機能

## 技術スタック
- **メール**: Resend（推奨）
- **Slack**: Slack Webhook
- **LINE**: LINE Notify API
- **データベース**: Supabase（通知設定の保存）

## 通知内容の例
```
【ReRank AI】順位下落を検知しました

記事URL: https://example.com/article
キーワード: ポケトモ 価格
順位: 3位 → 8位（5位下落）

原因: 「価格」「月額」などのキーワードが10位以下に転落

追加すべき項目:
- 観点: 価格比較
  項目: 価格比較表を追加してください

- 観点: デメリット解消法
  項目: デメリット解消法のセクションを追加してください
```

## テスト項目
- [ ] メール通知が正常に送信される
- [ ] Slack通知が正常に送信される（オプション）
- [ ] LINE通知が正常に送信される（オプション）
- [ ] 通知内容が正しくフォーマットされる
- [ ] エラーハンドリングが適切に動作する

## 見積もり
**期間**: 1-2日

## 関連ドキュメント
- [最小実装仕様](../docs/minimum-viable-implementation.md)
- [ユーザージャーニー](../docs/user-journey.md)
- [技術スタック](../docs/technical-stack.md)

