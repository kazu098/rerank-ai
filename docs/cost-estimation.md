# コスト見積もり

## 1記事あたりのコスト見積もり（変動費）

1回の分析（スキャン）にかかるAPIコストの概算です。
※ 1ドル=150円、1記事5,000文字程度の競合を3サイト分析すると想定。

| 項目 | 使用ツール/API | コスト(円) | 備考 |
|------|-------------|-----------|------|
| 検索・URL抽出 | ブラウジングツール（Playwright等） | 0円 | サーバーリソースのみ（Serper APIの代替） |
| 競合記事読込 | 自前クローラー（Beautiful Soup等） | 0円 | サーバーリソースのみ |
| 差分分析・生成 | Gemini 2.5 Flash | 約2.5円 | 入力1.5万+出力200-300トークン（箇条書き形式） |
| **合計コスト** | - | **約2.5円** | 1記事あたり約2.5円 |

## 結論

原価が非常に安いため（1記事あたり約2.5円）、無料枠を設けてもリスクが低く、高い利益率（90%以上）を確保しやすいモデルです。

**コスト削減の成果**:
- Serper API（約1.5円）をブラウジングツール（0円）に置き換えることで、約37.5%のコスト削減を実現

**コスト削減のポイント**:
- 競合記事のスクレイピングを自前クローラーで実装することで、Jina Reader等のAPIコストを削減
- サーバーリソースは固定費として計上するため、変動費を最小限に抑制

## コスト内訳の詳細

### ブラウジングツール（Playwright、Puppeteer、Cursorのブラウジングツール等）
- **用途**: 
  1. **競合URLの取得**（Serper APIの代替）
     - GSC APIで取得したキーワードと順位をもとに、Google検索を実行
     - 検索結果から自社URLより上位のサイトURLを抽出
  2. **現在の順位特定**（GSC連携不要の場合のみ）
     - キーワードで検索し、検索結果から自社URLの順位を特定
     - GSC連携時は、GSC APIから取得可能なので不要
- **料金**: 0円（サーバーリソースのみ、固定費として計上）
- **メリット**: 
  - Serper APIのコスト（約1.5円）を削減
  - GSC APIと統合しやすい（キーワードと順位のデータをそのまま活用）
- **デメリット**: 
  - 実行時間がやや遅い（5-10秒）
  - CAPTCHA対応が必要
  - レート制限への対策が必要
- **想定**: 
  - GSC連携時: 1回の検索実行（競合URL取得のみ）
  - 手動スキャン時: 1回の検索実行（競合URL取得 + 順位特定を同時に取得）
  - コスト: 0円（変動費なし）

### Serper.dev（フォールバックオプション）
- **用途**: ブラウジングツールが失敗した場合の代替手段
- **料金**: $0.01 per request
- **使用条件**: ブラウジングツールでCAPTCHAが表示された場合、または信頼性が問題になった場合

### 自前クローラー（Beautiful Soup等）
- **用途**: 競合サイトのHTMLを取得し、テキストを抽出
- **料金**: 無料（サーバーリソースのみ）
- **実装**: 
  - Beautiful Soup（Python）またはcheerio（Node.js）でHTMLパース
  - CursorのブラウジングツールやPlaywright等でJavaScriptレンダリングが必要なサイトにも対応
- **想定**: 競合3サイト分でコスト0円（サーバーリソースは固定費として計上）

### Gemini 2.5 Flash
- **用途**: 
  - 自社記事と競合記事の差分分析
  - リライト原稿の生成
- **料金**: 入力・出力トークン数に応じた従量課金
- **想定**: 
  - 入力: 約15,000トークン（自社記事5,000文字 + 競合3サイト分）
  - 出力: 約200-300トークン（箇条書き形式の追加項目提案）
  - 合計: 約2.5円
- **コスト削減のポイント**: 
  - 完璧な修正記事全文ではなく、箇条書き形式の追加項目提案にすることで、出力トークン数を約70%削減

## コスト削減のための施策

1. **ブラウジングツールの採用**
   - Serper API（約1.5円）をブラウジングツール（0円）に置き換えることで、コストを削減
   - GSC APIと統合しやすい（キーワードと順位のデータをそのまま活用）

2. **キャッシュの活用**
   - 同じ競合サイトを複数ユーザーが分析した場合、スクレイピング結果を再利用
   - ブラウジングツールの検索結果もキャッシュ可能（クローラーは自前のため追加コストなし）

2. **Gemini 2.5 Flashの採用**
   - ProではなくFlashを使用することで、コストを1/10以下に抑制
   - 品質は十分に維持可能

3. **バッチ処理**
   - 複数の分析をまとめて実行することで、API呼び出しのオーバーヘッドを削減

