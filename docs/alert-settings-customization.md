# アラート設定のカスタマイズ機能（将来機能）

## 概要

ユーザーが急落の判定条件や比較期間をカスタマイズできる機能。MVPではデフォルト設定で動作し、将来的に実装する。

## MVPでのデフォルト設定

### 急落の判定条件
- **平均順位の下落幅**: 2位以上下落
- **特定キーワードの転落条件**: 10位以下に転落

### 比較期間
- **過去何日間の平均順位**: 7日間

### 通知頻度
- **通知タイミング**: 毎日（急落時のみ通知）

## 将来機能：ユーザーがカスタマイズ可能な項目

### 1. 急落の判定条件

#### 平均順位の下落幅
- **デフォルト**: 2位以上下落
- **カスタマイズ可能な値**: 
  - 1.5位以上
  - 2位以上（デフォルト）
  - 3位以上
  - 5位以上
  - カスタム値（ユーザー入力）

#### 特定キーワードの転落条件
- **デフォルト**: 10位以下に転落
- **カスタマイズ可能な値**: 
  - 5位以下
  - 10位以下（デフォルト）
  - 15位以下
  - 20位以下
  - カスタム値（ユーザー入力）

### 2. 比較期間

#### 過去何日間の平均順位
- **デフォルト**: 7日間
- **カスタマイズ可能な値**: 
  - 3日間
  - 7日間（デフォルト）
  - 14日間
  - 30日間
  - カスタム値（ユーザー入力）

### 3. 通知頻度

#### 通知タイミング
- **デフォルト**: 毎日（急落時のみ通知）
- **カスタマイズ可能な値**: 
  - 毎日（急落時のみ通知）
  - 週1回まとめて（急落があった場合）
  - 急落時のみ（即座に通知）
  - 通知しない（手動で確認）

## 実装方針

### MVP段階
- **デフォルト設定で動作**: 過去7日間、2位以上下落、10位以下に転落
- **設定画面は不要**: 通知で完結

### 将来実装
- **設定画面の追加**: ダッシュボードに「アラート設定」画面を追加
- **データ保存**: ユーザー設定をデータベースに保存
- **設定の適用**: 定期実行時にユーザー設定を読み込んで適用

## 設定画面のUI設計（将来）

### アラート設定画面

```
アラート設定

1. 急落の判定条件
   □ 平均順位の下落幅
      [2] 位以上下落
   
   □ 特定キーワードの転落条件
      [10] 位以下に転落

2. 比較期間
   □ 過去何日間の平均順位
      [7] 日間
      （選択肢: 3日、7日、14日、30日、カスタム）

3. 通知頻度
   ○ 毎日（急落時のみ通知）
   ○ 週1回まとめて
   ○ 急落時のみ（即座に通知）
   ○ 通知しない

[保存] [デフォルトに戻す]
```

## データベース設計（将来）

### ユーザー設定テーブル

```sql
CREATE TABLE user_alert_settings (
  user_id UUID PRIMARY KEY,
  position_drop_threshold DECIMAL(3,1) DEFAULT 2.0,  -- 平均順位の下落幅
  keyword_fall_threshold INTEGER DEFAULT 10,          -- 特定キーワードの転落条件
  comparison_days INTEGER DEFAULT 7,                   -- 過去何日間の平均順位
  notification_frequency VARCHAR(20) DEFAULT 'daily', -- 通知頻度
  created_at TIMESTAMP,
  updated_at TIMESTAMP
);
```

## 実装優先度

- **MVP**: 不要（デフォルト設定で動作）
- **Phase 3以降**: 実装を検討
- **実装期間**: 約1週間（設定画面 + データ保存 + 設定の適用）

